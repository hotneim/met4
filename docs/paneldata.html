<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6.3 Paneldata | MET4 - Empiriske Metoder - Vår 2022</title>
  <meta name="description" content="Dette er hjemmesiden til kurset MET4 - Empiriske Metoder, som gis på bachelorstudiet ved Norges Handelshøyskole." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="6.3 Paneldata | MET4 - Empiriske Metoder - Vår 2022" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Dette er hjemmesiden til kurset MET4 - Empiriske Metoder, som gis på bachelorstudiet ved Norges Handelshøyskole." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6.3 Paneldata | MET4 - Empiriske Metoder - Vår 2022" />
  
  <meta name="twitter:description" content="Dette er hjemmesiden til kurset MET4 - Empiriske Metoder, som gis på bachelorstudiet ved Norges Handelshøyskole." />
  

<meta name="author" content="Håkon Otneim og Geir Drage Berentsen" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introduksjon-til-maskinlæring-med-knn.html"/>
<link rel="next" href="oppgaver-3.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link rel="apple-touch-icon" sizes="180x180" href="/met4/icon/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/met4/icon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/met4/icon/favicon-16x16.png">
<link rel="manifest" href="/met4/icon/site.webmanifest">
<link rel="mask-icon" href="/met4/icon/safari-pinned-tab.svg" color="#5bbad5">
<link rel="shortcut icon" href="/met4/icon/favicon.ico">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/met4/icon/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<a href="https://www.nhh.no/"><img src="bilder/nhh.png" width="240"></a>
<li><a href="./index.html">MET4 - EMPIRISKE METODER</a></li>

<li class="divider"></li>
<li><a href="index.html#innledning" id="toc-innledning">Innledning</a></li>
<li><a href="introduksjon-til-r.html#introduksjon-til-r" id="toc-introduksjon-til-r"><span class="toc-section-number">1</span> Introduksjon til R</a>
<ul>
<li><a href="en-gjennomgang-av-rstudio.html#en-gjennomgang-av-rstudio" id="toc-en-gjennomgang-av-rstudio"><span class="toc-section-number">1.1</span> En gjennomgang av RStudio</a></li>
<li><a href="enkle-beregninger-og-variabler.html#enkle-beregninger-og-variabler" id="toc-enkle-beregninger-og-variabler"><span class="toc-section-number">1.2</span> Enkle beregninger og variabler</a></li>
<li><a href="vektorer.html#vektorer" id="toc-vektorer"><span class="toc-section-number">1.3</span> Vektorer</a></li>
<li><a href="pakker.html#pakker" id="toc-pakker"><span class="toc-section-number">1.4</span> Pakker</a></li>
<li><a href="mappesti.html#mappesti" id="toc-mappesti"><span class="toc-section-number">1.5</span> Mappesti</a></li>
<li><a href="innlesing-av-data.html#innlesing-av-data" id="toc-innlesing-av-data"><span class="toc-section-number">1.6</span> Innlesing av data</a></li>
<li><a href="statistiske-analyser.html#statistiske-analyser" id="toc-statistiske-analyser"><span class="toc-section-number">1.7</span> Statistiske analyser</a></li>
<li><a href="r-plotting.html#r-plotting" id="toc-r-plotting"><span class="toc-section-number">1.8</span> Plotting</a></li>
<li><a href="script.html#script" id="toc-script"><span class="toc-section-number">1.9</span> Script</a></li>
<li><a href="pipe.html#pipe" id="toc-pipe"><span class="toc-section-number">1.10</span> Pipe-operatoren <code>%&gt;%</code> og enkel datavask</a></li>
<li><a href="r-ekstra.html#r-ekstra" id="toc-r-ekstra"><span class="toc-section-number">1.11</span> Oppsummering og ekstra oppgaver</a></li>
</ul></li>
<li><a href="grunnleggende-statistikk.html#grunnleggende-statistikk" id="toc-grunnleggende-statistikk"><span class="toc-section-number">2</span> Grunnleggende statistikk</a>
<ul>
<li><a href="deskriptiv-statistikk.html#deskriptiv-statistikk" id="toc-deskriptiv-statistikk"><span class="toc-section-number">2.1</span> Deskriptiv statistikk</a></li>
<li><a href="utvalg-og-estimering.html#utvalg-og-estimering" id="toc-utvalg-og-estimering"><span class="toc-section-number">2.2</span> Utvalg og estimering</a></li>
<li><a href="oppgaver.html#oppgaver" id="toc-oppgaver"><span class="toc-section-number">2.3</span> Oppgaver</a></li>
<li><a href="relevant-r-grunnleggende.html#relevant-r-grunnleggende" id="toc-relevant-r-grunnleggende"><span class="toc-section-number">2.4</span> Relevante R-kommandoer</a></li>
</ul></li>
<li><a href="hypotesetesting.html#hypotesetesting" id="toc-hypotesetesting"><span class="toc-section-number">3</span> Hypotesetesting</a>
<ul>
<li><a href="generelt-om-hypotesetesting.html#generelt-om-hypotesetesting" id="toc-generelt-om-hypotesetesting"><span class="toc-section-number">3.1</span> Generelt om hypotesetesting</a></li>
<li><a href="enpop.html#enpop" id="toc-enpop"><span class="toc-section-number">3.2</span> Inferens om en populasjon</a></li>
<li><a href="inferens-om-to-populasjoner.html#inferens-om-to-populasjoner" id="toc-inferens-om-to-populasjoner"><span class="toc-section-number">3.3</span> Inferens om to populasjoner</a></li>
<li><a href="kjikvadrattester.html#kjikvadrattester" id="toc-kjikvadrattester"><span class="toc-section-number">3.4</span> Kjikvadrattester</a></li>
<li><a href="oppgaver-1.html#oppgaver-1" id="toc-oppgaver-1"><span class="toc-section-number">3.5</span> Oppgaver</a></li>
<li><a href="relevante-r-testing.html#relevante-r-testing" id="toc-relevante-r-testing"><span class="toc-section-number">3.6</span> Relevante R-kommandoer</a></li>
</ul></li>
<li><a href="regresjon.html#regresjon" id="toc-regresjon"><span class="toc-section-number">4</span> Regresjon</a>
<ul>
<li><a href="enkel-regresjon.html#enkel-regresjon" id="toc-enkel-regresjon"><span class="toc-section-number">4.1</span> Enkel regresjon</a></li>
<li><a href="multippel-regresjon.html#multippel-regresjon" id="toc-multippel-regresjon"><span class="toc-section-number">4.2</span> Multippel regresjon</a></li>
<li><a href="modellbygging.html#modellbygging" id="toc-modellbygging"><span class="toc-section-number">4.3</span> Modellbygging</a></li>
<li><a href="oppgaver-2.html#oppgaver-2" id="toc-oppgaver-2"><span class="toc-section-number">4.4</span> Oppgaver</a></li>
<li><a href="relevante-r-regresjon.html#relevante-r-regresjon" id="toc-relevante-r-regresjon"><span class="toc-section-number">4.5</span> Relevante R-kommandoer</a></li>
</ul></li>
<li><a href="tidsrekker.html#tidsrekker" id="toc-tidsrekker"><span class="toc-section-number">5</span> Tidsrekker</a>
<ul>
<li><a href="intro.html#intro" id="toc-intro"><span class="toc-section-number">5.1</span> Introduksjon til tidsrekker</a></li>
<li><a href="trend-og-sesong.html#trend-og-sesong" id="toc-trend-og-sesong"><span class="toc-section-number">5.2</span> Trend og sesong</a></li>
<li><a href="ar.html#ar" id="toc-ar"><span class="toc-section-number">5.3</span> AR(p)</a></li>
<li><a href="stasjonaritet.html#stasjonaritet" id="toc-stasjonaritet"><span class="toc-section-number">5.4</span> Stasjonaritet</a></li>
<li><a href="autokorrelasjon.html#autokorrelasjon" id="toc-autokorrelasjon"><span class="toc-section-number">5.5</span> Autokorrelasjon</a></li>
<li><a href="ma.html#ma" id="toc-ma"><span class="toc-section-number">5.6</span> MA(q)</a></li>
<li><a href="arma-arima.html#arma-arima" id="toc-arma-arima"><span class="toc-section-number">5.7</span> ARMA og ARIMA</a></li>
<li><a href="modellbygging-1.html#modellbygging-1" id="toc-modellbygging-1"><span class="toc-section-number">5.8</span> Modellbygging</a></li>
<li><a href="relevante-r-tidsrekker.html#relevante-r-tidsrekker" id="toc-relevante-r-tidsrekker"><span class="toc-section-number">5.9</span> Relevante R-kommandoer</a></li>
</ul></li>
<li><a href="avansert-regresjon-og-maskinlæring.html#avansert-regresjon-og-maskinlæring" id="toc-avansert-regresjon-og-maskinlæring"><span class="toc-section-number">6</span> Avansert regresjon og maskinlæring</a>
<ul>
<li><a href="logistisk-regresjon.html#logistisk-regresjon" id="toc-logistisk-regresjon"><span class="toc-section-number">6.1</span> Logistisk regresjon</a></li>
<li><a href="introduksjon-til-maskinlæring-med-knn.html#introduksjon-til-maskinlæring-med-knn" id="toc-introduksjon-til-maskinlæring-med-knn"><span class="toc-section-number">6.2</span> Introduksjon til maskinlæring med kNN</a></li>
<li><a href="paneldata.html#paneldata" id="toc-paneldata"><span class="toc-section-number">6.3</span> Paneldata</a></li>
<li><a href="oppgaver-3.html#oppgaver-3" id="toc-oppgaver-3"><span class="toc-section-number">6.4</span> Oppgaver</a></li>
<li><a href="relevante-r-avansert-regresjon.html#relevante-r-avansert-regresjon" id="toc-relevante-r-avansert-regresjon"><span class="toc-section-number">6.5</span> Relevante R-kommandoer</a></li>
</ul></li>
<li><a href="dataøvinger.html#dataøvinger" id="toc-dataøvinger"><span class="toc-section-number">7</span> Dataøvinger</a>
<ul>
<li><a href="dataøving-1.html#dataøving-1" id="toc-dataøving-1"><span class="toc-section-number">7.1</span> Dataøving 1</a></li>
<li><a href="dataøving-2.html#dataøving-2" id="toc-dataøving-2"><span class="toc-section-number">7.2</span> Dataøving 2</a></li>
<li><a href="dataøving-3.html#dataøving-3" id="toc-dataøving-3"><span class="toc-section-number">7.3</span> Dataøving 3</a></li>
<li><a href="dataøving-4.html#dataøving-4" id="toc-dataøving-4"><span class="toc-section-number">7.4</span> Dataøving 4</a></li>
<li><a href="dataøving-5.html#dataøving-5" id="toc-dataøving-5"><span class="toc-section-number">7.5</span> Dataøving 5</a></li>
</ul></li>
<li><a href="diverse-ekstrastoff.html#diverse-ekstrastoff" id="toc-diverse-ekstrastoff"><span class="toc-section-number">8</span> Diverse ekstrastoff</a>
<ul>
<li><a href="skoleeksamen.html#skoleeksamen" id="toc-skoleeksamen"><span class="toc-section-number">8.1</span> Tidligere eksamensoppgaver (skoleeksamen)</a></li>
<li><a href="tidligere-eksamensoppgaver-hjemmeeksamen.html#tidligere-eksamensoppgaver-hjemmeeksamen" id="toc-tidligere-eksamensoppgaver-hjemmeeksamen"><span class="toc-section-number">8.2</span> Tidligere eksamensoppgaver (hjemmeeksamen)</a></li>
<li><a href="seminar.html#seminar" id="toc-seminar"><span class="toc-section-number">8.3</span> Oppgaver til seminarer</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://www.nhh.no/en/employees/faculty/hakon-otneim/">Håkon Otneim</a></li>
<li><a href="https://www.nhh.no/en/employees/faculty/geir-drage-berentsen/">Geir Drage Berentsen</a></li>
<li><a href="https://github.com/rstudio/bookdown">
Publisert ved hjelp av bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">MET4 - Empiriske Metoder - Vår 2022</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="paneldata" class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> Paneldata</h2>
<div id="videoforelesninger-11" class="section level3" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> Videoforelesninger</h3>
<div style="padding:56.25% 0 0 0;position:relative;">
<iframe src="https://vimeo.com/showcase/7802431/embed" allowfullscreen frameborder="0" style="position:absolute;top:0;left:0;width:100%;height:100%;">
</iframe>
</div>
</div>
<div id="kontrollspørsmål-6" class="section level3" number="6.3.2">
<h3><span class="header-section-number">6.3.2</span> Kontrollspørsmål</h3>
<ul>
<li>Hva er paneldata?</li>
<li>Hva må vi ta hensyn til når vi analyserer paneldata?</li>
<li>Hvordan ser en generell modell for paneldata ut?</li>
<li>Hva er den konseptuelle forskjellen mellom faste og tilfeldige effekter?</li>
<li>Når kan vi bruke faste effekter?</li>
<li>Når kan vi bruke tilfeldige effekter?</li>
<li>Finnes det en måte å formelt teste om man skal bruke faste eller tilfeldige effekter? (obs: se helt nederst på denne siden for svaret på denne.)</li>
</ul>
</div>
<div id="teori-og-r" class="section level3" number="6.3.3">
<h3><span class="header-section-number">6.3.3</span> Teori og R</h3>
<p>I denne forelesningen introduserer vi en ny datastruktur. Vi observerer flere individer (tversnittsdimensjonen) <em>gjentatte ganger</em> (tidsdimensjonen), og et slikt datasett kaller vi et <em>panel</em>, eller <em>paneldata</em>. Fordelen ved å jobbe med slike data er åpenbar: vi har mer informasjon og kan gjennomføre mer presise statistiske analyser. På den annen side må vi akseptere at en mer kompleks datastruktur gjør det nødvendig å innføre mer kompleks metodikk.</p>
<p>I gjennomgangen under bruker vi et liten del av dataene fra eksempelet som er beskrevet i videoene. Ønsker du å følge R-gjennomgangen laster du ned følgende datasett:</p>
<ul>
<li><a href="datasett/panel_liten.csv"><code>panel_liten.csv</code></a></li>
</ul>
<div id="struktur-på-paneldata" class="section level4" number="6.3.3.1">
<h4><span class="header-section-number">6.3.3.1</span> Struktur på Paneldata</h4>
<p>Til nå har vi typisk observert <span class="math inline">\(n\)</span> individer <em>en</em> gang. Hvis vi holder oss til eksempelet fra videoforelesningen, kan vi tenke oss at vi har spurt <span class="math inline">\(n\)</span> arbeidstakere om hvor mange timer de jobbet forrige år (<span class="math inline">\(X\)</span>), og hvor mye de hadde i timelønn (<span class="math inline">\(Y\)</span>). Da ville datasettet sett omtrent slik ut:</p>
<p><img src="bilder/panel1.PNG" /><!-- --></p>
<p>Her er <span class="math inline">\(y_i\)</span> timelønn til arbeidstaker nummer <span class="math inline">\(i\)</span>, og <span class="math inline">\(x_i\)</span> er antall timer jobbet for arbeidstaker nummer <span class="math inline">\(i\)</span>. Hvis vi så ønsker å se om det er en sammenheng mellom disse to variablene, kan vi sette opp en enkel regresjonsmodell som vi har gjort før:</p>
<p><span class="math display">\[\begin{equation}
y_i = \alpha + \beta x_i + \epsilon_i,
\label{p-ols}
\end{equation}\]</span>
der vi gjør de vanlige antakelsene om homoskedastisitet, uavhengige feilledd, og selvsagt at forklaringsvariabelen er <em>eksogen</em>, dvs at de stokastiske variablene <span class="math inline">\(X\)</span> og <span class="math inline">\(\epsilon\)</span> er <em>uavhengige fra hverandre</em>. Hvis vi aksepterer det, så kan vi estimere <span class="math inline">\(\beta\)</span> ved hjelp av minste kvadreters metode (OLS - orinary least squares), som vi kan tolke som forventet økning i timelønn ved å jobbe en time ekstra.</p>
<p>For paneldata har vi ikke lenger kun observert <span class="math inline">\(n\)</span> arbeidstakere 1 gang, men spurt <span class="math inline">\(N\)</span> arbeidstakere <span class="math inline">\(T\)</span> ganger, slik at vi trenger to indekser til å identifisere hver enkelt observasjon: <span class="math inline">\(y_{i,t}\)</span> er timelønn til arbeidstaker nummer <span class="math inline">\(i\)</span> ved tidspunkt <span class="math inline">\(t\)</span>. Våre observerte <span class="math inline">\(X\)</span>er og <span class="math inline">\(Y\)</span>er kan vi samle i en tabell som før, se illustrasjonen under. Legg merke til at det bare er de to første kolonnene for <span class="math inline">\(X\)</span> og <span class="math inline">\(Y\)</span> som utgjør de faktiske observasjonene, mens de to neste kolonnene sier hvilket individ som er observert, og ved hvilket tidspunkt observasjonen er utført, og viser bare indeksene til <span class="math inline">\(X\)</span>- og <span class="math inline">\(Y\)</span>-observasjonene. Kall det gjerne <em>metadata</em>, og vi trenger den informasjonen når vi skal utføre paneldatateknikker.</p>
<p><img src="bilder/panel2.PNG" /><!-- --></p>
<p>Formatet i tabellen over kalles gjerne et <em>langt</em> format, og omtrent samtlige R-pakker og funksjoner som brukes til å analysere panel data forventer at dataene er organisert på denne måten.</p>
<p>Vi kan ta en titt på hvordan dette ser ut i R for eksempelet vårt:</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="paneldata.html#cb182-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;panel_liten.csv&quot;</span>)              <span class="co"># Leser inn datasettet</span></span>
<span id="cb182-2"><a href="paneldata.html#cb182-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)                                       <span class="co"># Ser på datasettet</span></span></code></pre></div>
<pre><code>##      X lnhr lnwg kids age disab id year  mlhr  mlwg   dlhr    dwg
## 1 5241 7.71 3.19    0  30     0  1 1979 7.742 3.218 -0.032 -0.028
## 2 5242 7.64 3.14    0  32     0  1 1980 7.742 3.218 -0.102 -0.078
## 3 5243 7.71 3.11    0  33     0  1 1981 7.742 3.218 -0.032 -0.108
## 4 5244 7.72 3.00    0  34     0  1 1982 7.742 3.218 -0.022 -0.218
## 5 5245 7.72 2.94    0  35     0  1 1983 7.742 3.218 -0.022 -0.278
## 6 5246 7.73 3.12    1  35     0  1 1984 7.742 3.218 -0.012 -0.098</code></pre>
<p>Her svarer <code>lnwg</code>til responsvariabelen (log) lønn og <code>lnhr</code> til forklaringsvariabelen (log) antall timer jobbet. Legg merke til at det er en egen kolonne med navn <code>id</code> som forteller oss hvilket individ observasjonene gjelder for. Dette svarer til <span class="math inline">\(i\)</span>-indeksen i notasjonen over. Det er også en egen kolonne kalt <code>year</code> som forteller oss hvilket år observasjonen er fra, og dette svarer til <span class="math inline">\(t\)</span>-indeksen. F.eks er første rad observasjoner gjort for individ nr. 1 i år 1979.</p>
</div>
<div id="hva-må-vi-ta-hensyn-til" class="section level4" number="6.3.3.2">
<h4><span class="header-section-number">6.3.3.2</span> Hva må vi ta hensyn til?</h4>
<p>Hovedmotivasjonen for å analysere paneldata er ennå å undersøke sammenhengen mellom respons og forklaringsvariabelen. En slik måte å samle inn data på gir f.eks mer innformasjon om sammenhengen mellom timelønn og antall arbeidstimer fordi vi har flere observasjoner enn om vi bare betraktet en observasjon per individ. Men siden vi har gjentatte observasjoner over tid kan responsvariablene være avhengige. Vi kan se for oss to grunner til dette:</p>
<ol style="list-style-type: decimal">
<li>En utvikling i tid som er felles for alle individene; Det er f.eks tenkelig at det er en generell utvikling i lønnsnivået over tid, eller at det f.eks finnes <em>gode</em> år hvor alle tjener spesielt godt.</li>
<li>De gjentatte observasjonene for ett gitt individ vil typisk være avhengige; Har et individ høy inntekt det ene året er det tenkelig at det også har høy inntekt det neste året. Denne effekten kan misforstås som en effekt av forklaringsvariabelen.</li>
</ol>
<p>Altså må vi både ta hensyn til at det kan være en <em>generell</em> utvikling i tid og at det kan være <em>individuelt</em> forskjellige lønnsnivå. Disse aspektene kan nemlig påvirke vårt estimat av effekten av å jobbe mer dersom vi bruker den tradisjonelle regresjonsmodellen og OLS.</p>
<p>La oss inspisere de <span class="math inline">\(3\)</span> individene vi har data for i vårt lille datasett ved å lage et figur med lønnsutvikling (<code>lnwg</code>) langs y-aksen og år (<code>year</code>) langs x-aksen for å se om det finnes et slags felles mønster i lønnsutviklingen (ref. punkt 1. over):</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="paneldata.html#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)  </span>
<span id="cb184-2"><a href="paneldata.html#cb184-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df) <span class="sc">+</span></span>
<span id="cb184-3"><a href="paneldata.html#cb184-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> lnwg, <span class="at">color =</span> <span class="fu">factor</span>(id)))</span></code></pre></div>
<p><img src="met4_files/figure-html/unnamed-chunk-174-1.png" width="672" /></p>
<p>her ser vi f.eks at alle individene har et dårlig år i 1983, mens 1985 virker å være et godt år. Det også tydelig at lønnen holder seg relavivt lik lønnen det foregående året. Det er altså rimelig å tro at det er fellestrekk i lønnen til individene for gitte år.</p>
<p>La oss så lage et spredningsplott mellom <code>lnhr</code> og <code>lnwg</code> hvor vi fargelegger hvilket individ observasjonene kommer fra:</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="paneldata.html#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)  </span>
<span id="cb185-2"><a href="paneldata.html#cb185-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df) <span class="sc">+</span></span>
<span id="cb185-3"><a href="paneldata.html#cb185-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> lnhr, <span class="at">y =</span> lnwg, <span class="at">color =</span> <span class="fu">factor</span>(id)))</span></code></pre></div>
<p><img src="met4_files/figure-html/unnamed-chunk-175-1.png" width="672" /></p>
<p>Ser vi på disse dataene samlet sett ser du til å være en klart positiv korrelasjon mellom lønn og antall timer jobbet. Men legg merke til at individ nr. 1 ligger på et høyere lønnsnivå og jobber mer enn de to andre individene. Det er dette som i stor grad skaper et bilde av en sterk positiv sammenheng mellom variablene. Hvis vi ser på de individuelle observasjonene (hver fargesky) hver for seg, virker ikke sammenhengen å være like sterk, og det har kanskje ikke like mye å si for lønnen om du individuelt velger å jobber mer. Dette svarer til fenomenet beskrevet i punkt 2. over.</p>
</div>
<div id="generelt-oppsett-av-modell" class="section level4" number="6.3.3.3">
<h4><span class="header-section-number">6.3.3.3</span> Generelt oppsett av modell</h4>
<p>Effektene av de fenomene vi beskrev over kan vi ta hensyn til ved å <em>inkludere</em> dem i regresjonsmodellen på følgende måte:</p>
<p><span class="math display">\[y_{it} = \beta_0 + \beta_1 x_{it} + v_t + \alpha_i + \epsilon_{it} \]</span>
hvor vi nå har lagt til to nye ledd, <span class="math inline">\(v_t\)</span> og <span class="math inline">\(\alpha_i\)</span>, i modellen:</p>
<ol style="list-style-type: decimal">
<li><p>Her representerer <span class="math inline">\(v_t\)</span> den generelle utviklingen i tid som er felles for alle individene (det er ingen “i”-indeks i denne). Det kan f.eks være en lineær trend (<span class="math inline">\(v_t = \delta t\)</span>) eller helt unike årlige effekter <span class="math inline">\(v_t\)</span>, som fanger opp <em>gode</em> og <em>dårlige</em> år.</p></li>
<li><p>Leddene <span class="math inline">\(\alpha_i\)</span> representerer så de individuelle lønnsnivåene (disse er “i” indeksert). Har individ <span class="math inline">\(1\)</span> høyere lønn enn individ <span class="math inline">\(2\)</span> så vil <span class="math inline">\(\alpha_1\)</span> blir estimert til å være større enn <span class="math inline">\(\alpha_2\)</span>.</p></li>
</ol>
<p>Vi justerer altså for at individer kan ligge på et forskjellig lønnsnivå, og at det er en felles årlige variasjoner i lønn. I praksis betyr dette at vi justerer regresjonslinjen <em>vertikalt</em> slik at den tilpasser seg lønnsnivået til hvert individ. Effekten <span class="math inline">\(\beta_1\)</span> av å jobbe mer er derimot antatt lik for hvert individ og den estimerte effekten vil da bli et slags gjennomsnitt av hvor mye det individuelt lønner seg å jobbe mer.</p>
<p>I utgangspunktet kan vi betrakte <span class="math inline">\(v_t\)</span> og <span class="math inline">\(\alpha_i\)</span> som kategoriske variabler som kan estimeres ved hjelp av dummyvariabler slik vi har lært før. Problemet er at i et tradisjonelt paneldatasett så er <span class="math inline">\(N\)</span> (antall individer) et stort tall, mens <span class="math inline">\(T\)</span> (antall observasjoner per individ) et relativt lite tall. Dette fører til svært mange kategoriske variabler <span class="math inline">\(\alpha_i\)</span> å estimere, og i praksis må vi derfor betrakte andre metoder. Vi noterer oss følgende:</p>
<ul>
<li><p>Egenskapene til <span class="math inline">\(\alpha_i\)</span> bestemmer typen paneldatamodell og vi deler disse modellene grovt sett inn i modeller med <em>faste effekter</em> og <em>tilfeldige effekter</em>. Selve ligningene vil altså se like ut, men tolkning og estimering er forskjellig.</p></li>
<li><p>Leddene <span class="math inline">\(v_t\)</span> vil vi i de fleste tilfeller klare å estimere som kategoriske variabler og i fortsettelsen ser vi bort fra dette leddet</p></li>
<li><p>For enkelthets skyld betrakter vi bare èn forklaringsvariabel, men det kan selvsagt være flere forklaringsvariabler i en regresjonsmodell for panel data også.</p></li>
</ul>
</div>
<div id="forskjellige-parameteriseringer" class="section level4" number="6.3.3.4">
<h4><span class="header-section-number">6.3.3.4</span> Forskjellige parameteriseringer</h4>
<p>Merk at det både i lærebøker og i forskjellige R-pakker veksles mellom å to typer formuleringer av den generelle modellen over. Hvis vi ser bort fra <span class="math inline">\(v_t\)</span> leddet, er modellen vi til nå har betraktet formulert som:</p>
<p><span class="math display" id="eq:withb">\[\begin{align}
y_{it} = \beta_0 + \beta_1 x_{it}  + \alpha_i + \epsilon_{it}
\tag{6.1}
\end{align}\]</span></p>
<p>hvor <span class="math inline">\(\beta_0\)</span> er inkludert. Her kan <span class="math inline">\(\beta_0\)</span> tolkes som det <em>gjennomsnittlige</em> skjæringspunktet med y-aksen blant de individuelle regresjonslinjene, mens <span class="math inline">\(\beta_0 + \alpha_i\)</span> vil være skjæringspunktet med y-aksen for individ nr. <span class="math inline">\(i\)</span>. Men det er også svært vanlig (og kanskje litt lettere) å formulere modellen uten <span class="math inline">\(\beta_0\)</span>:</p>
<p><span class="math display" id="eq:withoutb">\[\begin{align}
y_{it} = \beta_1 x_{it}  + \alpha_i + \epsilon_{it}
\tag{6.2}
\end{align}\]</span></p>
<p>og da vil <span class="math inline">\(\alpha_i\)</span> være det individuelle skjæringspunktet med y-aksen for individ nr. <span class="math inline">\(i\)</span>. Forskjellen er rett og slett tolkningsmessig. I videoen for faste effekter går vi igjennom estimeringen av begge modellene, men under betrakter vi bare estimering av sistnevnte modell når vi bruker faste effekter. Dette gjør vi siden modellen i R er definert på denne måten. Når vi så ser på <em>tilfeldige effekter</em> vil vi av samme grunn betrakte modell <a href="paneldata.html#eq:withb">(6.1)</a>.</p>
</div>
<div id="faste-effekter" class="section level4" number="6.3.3.5">
<h4><span class="header-section-number">6.3.3.5</span> Faste effekter</h4>
<p>I en modell med <em>faste effekter</em> betrakter vi <span class="math inline">\(\alpha_i\)</span> leddene som <em>faste størrelser</em> som må estimeres. Denne modellen er omtrent alltid gyldig og kan brukes selv om vi tror de individuelle forskjellene <span class="math inline">\(\alpha_i\)</span> er relativt store og at det er avhengighet mellom forklaringsvariabelen(e) og <span class="math inline">\(\alpha_i\)</span>.</p>
<p>I modellen vår som er formulert som</p>
<p><span class="math display">\[y_{it} = \beta_1 x_{it}  + \alpha_i + \epsilon_{it} \]</span></p>
<p>skal vi altså estimere <span class="math inline">\(\alpha_1, \alpha_2, ..., \alpha_N\)</span> samt effekten av det å jobbe mer <span class="math inline">\(\beta_1\)</span>. Det finnes en rekke estimeringsteknikker og vi vil her (og i videoen) bare beskrive en metode.</p>
<p>Vi begynner med å ta tidsgjennomsnittet av ligningen over for hvert individ:</p>
<p><span class="math display">\[1/T \sum_{t = 1}^T y_{it} = 1/T \sum_{t = 1}^T \beta_1 x_{it} + 1/T \sum_{t = 1}^T \alpha_i + 1/T \sum_{t = 1}^T \epsilon_{it}\]</span>
Her vil tidsgjennomsnittet av <span class="math inline">\(\alpha_i\)</span> bare være <span class="math inline">\(\alpha_i\)</span> siden dette leddet ikke varierer med tiden. Altså kan vi skrive ligningen over som:</p>
<p><span class="math display" id="eq:timemean">\[\begin{align}
\overline{y}_{i} = \beta_1\overline{x}_i + \alpha_i + \overline{\epsilon}_i
\tag{6.3}
\end{align}\]</span></p>
<p>Her er henholdsvis <span class="math inline">\(\overline{y}_i\)</span> og <span class="math inline">\(\overline{x}_i\)</span> den gjennomsnittlige lønnen og antall timer jobbet for individ nr. i, og dette er størrelser vi kan regne ut. Vi tar så vår originale modell å trekker fra denne ligningen:</p>
<p><span class="math display">\[y_{it} - \overline{y}_{i}  = \beta_1(x_{it} - \overline{x}_i) + \alpha_i - \alpha_i +  \epsilon_{it} - \overline{\epsilon}_i\]</span>
Nøkkelen her er at <span class="math inline">\(\alpha_i\)</span>-leddene kansellerer hverandre og vi kan formulere en ligning helt uten disse leddene:</p>
<p><span class="math display">\[\tilde{y}_{it} = \beta_1\tilde{x}_{it} + \tilde{\epsilon}_{it},\]</span>
hvor <span class="math inline">\(\tilde{y}_{it} = y_{it} - \overline{y}_{i}\)</span>, <span class="math inline">\(\tilde{x}_{it} = x_{it} - \overline{x}_{i}\)</span> og <span class="math inline">\(\tilde{\epsilon}_{it} = \epsilon_{it} - \overline{\epsilon}_{i}\)</span>.</p>
<p>Siden vi nå ikke lenger har <span class="math inline">\(\alpha_i\)</span> i ligningen, og siden <span class="math inline">\(\tilde{\epsilon}_{it}\)</span> bare er et nytt feilledd sentrert rundt null, kan vi estimere <span class="math inline">\(\beta_1\)</span> ved vanlig OLS, altså velge den verdien <span class="math inline">\(\hat{\beta}_1\)</span> som minimerer:</p>
<p><span class="math display">\[\sum_{i=1}^N\sum_{t=1}^T(\tilde{y}_{it} - \beta_1\tilde{x}_{it})^2\]</span></p>
<p>Gitt et estimat av <span class="math inline">\(\beta_1\)</span> kan vi få estimater av <span class="math inline">\(\alpha_1, \dots, \alpha_N\)</span> ved å og ta forventning av den tidsgjennomsnittlige modellen <a href="paneldata.html#eq:timemean">(6.3)</a> (da forsvinner <span class="math inline">\(\overline{\epsilon}_{it}\)</span> leddet), erstatte <span class="math inline">\(\beta_1\)</span> med estimatet <span class="math inline">\(\hat{\beta}_1\)</span> og løse ligningen m.h.p <span class="math inline">\(\alpha_i\)</span>.</p>
<p><span class="math display">\[\begin{align}
\hat{\alpha}_1 &amp;= \overline{y}_{1} - \hat{\beta}_1\overline{x}_1\\
\hat{\alpha}_2 &amp;= \overline{y}_{2} - \hat{\beta}_1\overline{x}_2\\
&amp;\vdots\\
\hat{\alpha}_N &amp;= \overline{y}_{N} - \hat{\beta}_1\overline{x}_N\\
\end{align}\]</span></p>
<p>Sluttproduktet er derfor <span class="math inline">\(N\)</span> individuelle regresjonslinjer:</p>
<p><span class="math display">\[\begin{align}
y_{1t} &amp;= \hat{\alpha}_1 + \hat{\beta}_1 x_{1t}   \\
y_{2t} &amp;= \hat{\alpha}_2 + \hat{\beta}_1 x_{2t}   \\
&amp;\vdots\\
y_{Nt} &amp;= \hat{\alpha}_N + \hat{\beta}_1 x_{Nt}   \\
\end{align}\]</span></p>
<p>som har individuelle skjæringspunkt med <span class="math inline">\(y\)</span>-aksen (<span class="math inline">\(\hat{\alpha}_i\)</span>) for å justere for forskjellig lønnsnivå, men hvor <em>alle</em> observasjonene har blitt brukt til å estimere det felles stigningstallet <span class="math inline">\(\hat{\beta}_1\)</span>.</p>
<p>Det er verdt å merke seg at denne metoden ikke kan brukes dersom forklaringsvariabelen ikke varierer med tid (eksempelvis kjønn). Da vil nemlig <span class="math inline">\(x_{it} - \overline{x}_i = x_{it} - x_{it} = 0\)</span>, og vi har derfor ingen mulighet til å estimere <span class="math inline">\(\beta_1\)</span> med OLS.</p>
<p>Det finnes flere pakker som kan estimere slike modeller i R, men en veldig enkel pakke å bruke heter <code>plm</code>. Det første vi gjør er å laste pakken forså å “oversette” dataene våre til paneldata. På denne måten forstår <code>plm</code> funksjonen hva som er individ indeksen og hva som er tidsinndeksen:</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="paneldata.html#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plm)      <span class="co"># Pakke for å estimere faste effekter</span></span>
<span id="cb186-2"><a href="paneldata.html#cb186-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-3"><a href="paneldata.html#cb186-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Oversetter til panel data frame</span></span>
<span id="cb186-4"><a href="paneldata.html#cb186-4" aria-hidden="true" tabindex="-1"></a>p.df <span class="ot">&lt;-</span> <span class="fu">pdata.frame</span>(df,</span>
<span id="cb186-5"><a href="paneldata.html#cb186-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">index =</span> <span class="fu">c</span>(<span class="st">&quot;id&quot;</span> ,<span class="st">&quot;year&quot;</span>))</span></code></pre></div>
<p>Syntaksen for å bruke <code>plm</code> funksjonen er svært lik den for <code>lm</code> og <code>glm</code>. For å bruke en modell med faste effekter må man huske å spesifiserer argumentet <code>model = "within"</code>:</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="paneldata.html#cb187-1" aria-hidden="true" tabindex="-1"></a>reg.fe <span class="ot">&lt;-</span> <span class="fu">plm</span>(lnwg <span class="sc">~</span> lnhr,</span>
<span id="cb187-2"><a href="paneldata.html#cb187-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> p.df,</span>
<span id="cb187-3"><a href="paneldata.html#cb187-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">model =</span> <span class="st">&quot;within&quot;</span>)</span>
<span id="cb187-4"><a href="paneldata.html#cb187-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg.fe)</span></code></pre></div>
<pre><code>## Oneway (individual) effect Within Model
## 
## Call:
## plm(formula = lnwg ~ lnhr, data = p.df, model = &quot;within&quot;)
## 
## Balanced Panel: n = 3, T = 10, N = 30
## 
## Residuals:
##      Min.   1st Qu.    Median   3rd Qu.      Max. 
## -0.270016 -0.042538 -0.011427  0.051738  0.336355 
## 
## Coefficients:
##      Estimate Std. Error t-value Pr(&gt;|t|)
## lnhr  0.36293    0.26210  1.3847   0.1779
## 
## Total Sum of Squares:    0.37546
## Residual Sum of Squares: 0.34967
## R-Squared:      0.068678
## Adj. R-Squared: -0.038782
## F-statistic: 1.91731 on 1 and 26 DF, p-value: 0.17792</code></pre>
<p>Vi ser at den estimerte <span class="math inline">\(\beta_1\)</span> effekten av å jobbe mer estimeres til <span class="math inline">\(0.36\)</span>. Vi kan også få ut estimatene for de faste effektene <span class="math inline">\(\alpha_1\)</span>, <span class="math inline">\(\alpha_2\)</span> og <span class="math inline">\(\alpha_3\)</span>:</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="paneldata.html#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fixef</span>(reg.fe)</span></code></pre></div>
<pre><code>##         1         2         3 
##  0.408228 -0.062905 -0.279994</code></pre>
<p>Det kan være nyttig å ta en visuell innspeksjon på hvordan de individuelle regresjonskurvene passer til dataene:</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="paneldata.html#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(reg.fe)</span></code></pre></div>
<p><img src="met4_files/figure-html/unnamed-chunk-179-1.png" width="672" /></p>
<p>Denne figuren viser også hvordan regresjonskurven ville sett ut dersom vi hadde sett bort fra paneldatastrukturen og brukt en helt vanlig (pooled) regresjonsmodell. Sammenlignet med modellen med faste faste effekter (within) så ville vi da estimert effekten av jobbe mer til å være større. Selv om produktet her er <span class="math inline">\(3\)</span> individuelle regresjonsmodeller, presiserer vi at dette ikke er <span class="math inline">\(3\)</span> uavhengige analyser; alle observasjonene er brukt til å finne et estimat på <span class="math inline">\(\beta_1\)</span>.</p>
<p>Vi husker at det også kunne være en felles tidskomponent <span class="math inline">\(v_t\)</span> i en slik modell og at denne kunne betraktes som en kategorisk variabel siden det typisk ikke er så mange (<span class="math inline">\(T\)</span>) av disse. Vi kan derfor bare legge til <code>year</code> som en ekstra (kategorisk) forklaringsvariabel forutsatt at den er koded som en <code>factor</code>:</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="paneldata.html#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.factor</span>(p.df<span class="sc">$</span>year)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="paneldata.html#cb194-1" aria-hidden="true" tabindex="-1"></a>reg.fe <span class="ot">&lt;-</span> <span class="fu">plm</span>(lnwg <span class="sc">~</span> lnhr <span class="sc">+</span> year,</span>
<span id="cb194-2"><a href="paneldata.html#cb194-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> p.df,</span>
<span id="cb194-3"><a href="paneldata.html#cb194-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">model =</span> <span class="st">&quot;within&quot;</span>)</span>
<span id="cb194-4"><a href="paneldata.html#cb194-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg.fe)</span></code></pre></div>
<pre><code>## Oneway (individual) effect Within Model
## 
## Call:
## plm(formula = lnwg ~ lnhr + year, data = p.df, model = &quot;within&quot;)
## 
## Balanced Panel: n = 3, T = 10, N = 30
## 
## Residuals:
##       Min.    1st Qu.     Median    3rd Qu.       Max. 
## -0.1740253 -0.0689048  0.0054976  0.0668643  0.2081334 
## 
## Coefficients:
##           Estimate Std. Error t-value Pr(&gt;|t|)
## lnhr      0.182181   0.317431  0.5739   0.5735
## year1980  0.030310   0.095869  0.3162   0.7557
## year1981  0.015762   0.095752  0.1646   0.8712
## year1982 -0.050297   0.095805 -0.5250   0.6064
## year1983 -0.063590   0.103765 -0.6128   0.5481
## year1984  0.031862   0.102964  0.3094   0.7607
## year1985  0.162429   0.095752  1.6964   0.1081
## year1986  0.066977   0.095869  0.6986   0.4942
## year1987  0.082429   0.095752  0.8609   0.4013
## year1988  0.087881   0.095682  0.9185   0.3712
## 
## Total Sum of Squares:    0.37546
## Residual Sum of Squares: 0.23334
## R-Squared:      0.37853
## Adj. R-Squared: -0.060163
## F-statistic: 1.03543 on 10 and 17 DF, p-value: 0.45624</code></pre>
<p>For dette lekedatasettet kunne vi strengt tatt også betraktet <span class="math inline">\(\alpha_i\)</span>-leddene som kategoriske variabler, men som sagt er som regel <span class="math inline">\(N\)</span> for stor til at dette lar seg gjøre.</p>
</div>
<div id="tilfeldige-effekter" class="section level4" number="6.3.3.6">
<h4><span class="header-section-number">6.3.3.6</span> Tilfeldige effekter</h4>
<p>Hovedmotivasjonen for analysen av paneldataene er å finne ut hva effekten av å jobbe mer er (<span class="math inline">\(\beta_1\)</span>). Vi vet at det eksisterer individuelle effekter <span class="math inline">\(\alpha_i\)</span> som en konsekvens av datastrukturen, men vi er ikke nødvendigvis interessert i disse verdiene i seg selv.</p>
<p>I motsetning til en modell med <em>faste effekter</em> hvor vi betraktet <span class="math inline">\(\alpha_i\)</span> som faste størrelser, vil vi i en modell med <em>tilfeldige effekter</em> betrakte disse som <em>tilfeldige variabler</em>. I en slik modell estimerer vi derfor heller <em>fordelingen</em> til disse effektene. En vanlig antagelse er da at</p>
<p><em><span class="math inline">\(\alpha_i\sim N(0, \sigma_{\alpha}^2)\)</span> dersom vi bruker parameteriseringen <a href="paneldata.html#eq:withb">(6.1)</a> med <span class="math inline">\(\beta_0\)</span> inkludert.<br />
</em> <span class="math inline">\(\alpha_i\sim N(\beta_0, \sigma_{\alpha}^2)\)</span> dersom vi bruker parameteriseringen <a href="paneldata.html#eq:withoutb">(6.2)</a> uten <span class="math inline">\(\beta_0\)</span>.</p>
<p>Variansen <span class="math inline">\(\sigma_{\alpha}^2\)</span> er da et mål på <em>uobservert heterogenitet</em>; i dette tilfellet hvor stor variasjon det i lønnsnivået mellom individene. Det også vanlig å anta at <span class="math inline">\(\epsilon_{it}\sim N(0, \sigma_{\epsilon}^2)\)</span>, så i en slik modell skal vi altså estimere <span class="math inline">\(\beta_1\)</span> (og <span class="math inline">\(\beta_0\)</span>), <span class="math inline">\(\sigma_{\alpha}^2\)</span> og <span class="math inline">\(\sigma_{\epsilon}^2\)</span>. Vi bruker altså bare èn ekstra parameter (<span class="math inline">\(\sigma_{\alpha}^2\)</span>) for å justere for forskjellen i lønnsnivåene. Sammenligner vi dette med modellen med faste effekter der vi trengte <span class="math inline">\(N\)</span> (<span class="math inline">\(\alpha_1, \alpha_2,\dots,\alpha_N\)</span>) ekstra parametre er dette en mye enklere modell.</p>
<p>En modell med tilfeldige effekter brukes dersom det er rimelig å anta at de individuelle effektene <span class="math inline">\(\alpha_i\)</span> er små og uavhengig av forklaringsvariabelen(e). Dersom dette er oppfylt viser det seg at en kan få mer presise estimat av effekten vi egentlig er interessert i , <span class="math inline">\(\beta_1\)</span>. Det finnes en rekke estimeringsmetoder og vi skal ikke gå detaljer på noen her, men nevner:</p>
<ul>
<li>Varianter av minstekvadraters metode som kan minne om det vi gjorde for faste effekter.</li>
<li>Sannsynlighetsmaksimeringsestimering.</li>
<li>Bayesiansk estimering.</li>
</ul>
<p>De to siste metodene er mye brukt for å estimere tilfeldige effekter.</p>
<p>I R kan vi fortsatt bruke <code>plm</code>, men må endre <code>model</code> argumentet til <code>"random"</code>:</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="paneldata.html#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tilfeldig effekt modell</span></span>
<span id="cb196-2"><a href="paneldata.html#cb196-2" aria-hidden="true" tabindex="-1"></a>reg.re <span class="ot">&lt;-</span> <span class="fu">plm</span>(lnwg <span class="sc">~</span> lnhr,</span>
<span id="cb196-3"><a href="paneldata.html#cb196-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> p.df,</span>
<span id="cb196-4"><a href="paneldata.html#cb196-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">model =</span> <span class="st">&quot;random&quot;</span>)</span>
<span id="cb196-5"><a href="paneldata.html#cb196-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg.re)</span></code></pre></div>
<pre><code>## Oneway (individual) effect Random Effect Model 
##    (Swamy-Arora&#39;s transformation)
## 
## Call:
## plm(formula = lnwg ~ lnhr, data = p.df, model = &quot;random&quot;)
## 
## Balanced Panel: n = 3, T = 10, N = 30
## 
## Effects:
##                   var std.dev share
## idiosyncratic 0.01345 0.11597 0.356
## individual    0.02429 0.15586 0.644
## theta: 0.771
## 
## Residuals:
##      Min.   1st Qu.    Median   3rd Qu.      Max. 
## -0.182643 -0.082132 -0.017109  0.046306  0.421926 
## 
## Coefficients:
##             Estimate Std. Error z-value Pr(&gt;|z|)  
## (Intercept) -1.35059    2.17414 -0.6212  0.53446  
## lnhr         0.54307    0.28506  1.9051  0.05677 .
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Total Sum of Squares:    0.53409
## Residual Sum of Squares: 0.47281
## R-Squared:      0.11475
## Adj. R-Squared: 0.083133
## Chisq: 3.62944 on 1 DF, p-value: 0.056766</code></pre>
<p>I motsetningen til modellen vi estimerte med faste effekter er nå parameteriseringen gjort med <span class="math inline">\(\beta_0\)</span> leddet inkludert (modell <a href="paneldata.html#eq:withb">(6.1)</a>) og vi ser at dette blir estimert til å være <span class="math inline">\(-1.35\)</span>. Videre estimeres effekten av å jobbe mer til <span class="math inline">\(\hat{\beta}_1 = 0.54\)</span>. Litt lenger oppe i utskriften ser vi at <span class="math inline">\(\hat{\sigma}^2_{\alpha}= 0.0242\)</span> (“individual”), mens <span class="math inline">\(\hat{\sigma}^2_{\epsilon}= 0.0134\)</span> (“idiosyncratic”).</p>
</div>
<div id="hausman-test" class="section level4" number="6.3.3.7">
<h4><span class="header-section-number">6.3.3.7</span> Hausman test</h4>
<p>En modell med faste effekter vil være mulig å bruke i alle tilfeller, mens en modell med tilfeldige effekter har strengere krav til hvordan disse individuelle effektene oppfører seg. Dersom disse er oppfylt er det en fordel å bruke en modell med tilfeldige effekter.</p>
<p>En strategi for å finne riktig modell er å estimere begge modellene forså å utføre en såkalt Hausman test. Nullhypotesen er da at den riktige modellen er den med tilfeldige effekter. Forkaster vi bruker vi modellen med faste effekter, forkaster vi ikke bruker vi modellen med tilfeldige effekter.</p>
<p>I R utfører vi testen slik:</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="paneldata.html#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Hausman test</span></span>
<span id="cb198-2"><a href="paneldata.html#cb198-2" aria-hidden="true" tabindex="-1"></a><span class="fu">phtest</span>(reg.fe, reg.re)</span></code></pre></div>
<pre><code>## 
##  Hausman Test
## 
## data:  lnwg ~ lnhr + year
## chisq = 6.6775, df = 1, p-value = 0.009764
## alternative hypothesis: one model is inconsistent</code></pre>
<p>Siden vi får forkastning vil den beste modellen for dette (leke-) datasettet være modellen med faste effekter.</p>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduksjon-til-maskinlæring-med-knn.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="oppgaver-3.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"toc_depth": 4
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
