<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7.2 Dataøving 2 | MET4 - Empiriske Metoder - Høst 2021</title>
  <meta name="description" content="Dette er hjemmesiden til kurset MET4 - Empiriske Metoder, som gis på bachelorstudiet ved Norges Handelshøyskole." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="7.2 Dataøving 2 | MET4 - Empiriske Metoder - Høst 2021" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Dette er hjemmesiden til kurset MET4 - Empiriske Metoder, som gis på bachelorstudiet ved Norges Handelshøyskole." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7.2 Dataøving 2 | MET4 - Empiriske Metoder - Høst 2021" />
  
  <meta name="twitter:description" content="Dette er hjemmesiden til kurset MET4 - Empiriske Metoder, som gis på bachelorstudiet ved Norges Handelshøyskole." />
  

<meta name="author" content="Håkon Otneim og Geir Drage Berentsen" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="dataøving-1.html"/>
<link rel="next" href="dataøving-3.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<a href="https://www.nhh.no/"><img src="bilder/nhh.png" width="240"></a>
<li><a href="./index.html">MET4 - EMPIRISKE METODER</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Innledning</a></li>
<li class="chapter" data-level="1" data-path="introduksjon-til-r.html"><a href="introduksjon-til-r.html"><i class="fa fa-check"></i><b>1</b> Introduksjon til R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="en-gjennomgang-av-rstudio.html"><a href="en-gjennomgang-av-rstudio.html"><i class="fa fa-check"></i><b>1.1</b> En gjennomgang av RStudio</a></li>
<li class="chapter" data-level="1.2" data-path="enkle-beregninger-og-variabler.html"><a href="enkle-beregninger-og-variabler.html"><i class="fa fa-check"></i><b>1.2</b> Enkle beregninger og variabler</a></li>
<li class="chapter" data-level="1.3" data-path="vektorer.html"><a href="vektorer.html"><i class="fa fa-check"></i><b>1.3</b> Vektorer</a></li>
<li class="chapter" data-level="1.4" data-path="pakker.html"><a href="pakker.html"><i class="fa fa-check"></i><b>1.4</b> Pakker</a></li>
<li class="chapter" data-level="1.5" data-path="mappesti.html"><a href="mappesti.html"><i class="fa fa-check"></i><b>1.5</b> Mappesti</a></li>
<li class="chapter" data-level="1.6" data-path="innlesing-av-data.html"><a href="innlesing-av-data.html"><i class="fa fa-check"></i><b>1.6</b> Innlesing av data</a></li>
<li class="chapter" data-level="1.7" data-path="statistiske-analyser.html"><a href="statistiske-analyser.html"><i class="fa fa-check"></i><b>1.7</b> Statistiske analyser</a></li>
<li class="chapter" data-level="1.8" data-path="plotting.html"><a href="plotting.html"><i class="fa fa-check"></i><b>1.8</b> Plotting</a></li>
<li class="chapter" data-level="1.9" data-path="script.html"><a href="script.html"><i class="fa fa-check"></i><b>1.9</b> Script</a></li>
<li class="chapter" data-level="1.10" data-path="r-ekstra.html"><a href="r-ekstra.html"><i class="fa fa-check"></i><b>1.10</b> Oppsummering og ekstra oppgaver</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="grunnleggende-statistikk.html"><a href="grunnleggende-statistikk.html"><i class="fa fa-check"></i><b>2</b> Grunnleggende statistikk</a>
<ul>
<li class="chapter" data-level="2.1" data-path="deskriptiv-statistikk.html"><a href="deskriptiv-statistikk.html"><i class="fa fa-check"></i><b>2.1</b> Deskriptiv statistikk</a></li>
<li class="chapter" data-level="2.2" data-path="utvalg-og-estimering.html"><a href="utvalg-og-estimering.html"><i class="fa fa-check"></i><b>2.2</b> Utvalg og estimering</a></li>
<li class="chapter" data-level="2.3" data-path="oppgaver.html"><a href="oppgaver.html"><i class="fa fa-check"></i><b>2.3</b> Oppgaver</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="hypotesetesting.html"><a href="hypotesetesting.html"><i class="fa fa-check"></i><b>3</b> Hypotesetesting</a>
<ul>
<li class="chapter" data-level="3.1" data-path="generelt-om-hypotesetesting.html"><a href="generelt-om-hypotesetesting.html"><i class="fa fa-check"></i><b>3.1</b> Generelt om hypotesetesting</a></li>
<li class="chapter" data-level="3.2" data-path="enpop.html"><a href="enpop.html"><i class="fa fa-check"></i><b>3.2</b> Inferens om en populasjon</a></li>
<li class="chapter" data-level="3.3" data-path="inferens-om-to-populasjoner.html"><a href="inferens-om-to-populasjoner.html"><i class="fa fa-check"></i><b>3.3</b> Inferens om to populasjoner</a></li>
<li class="chapter" data-level="3.4" data-path="kjikvadrattester.html"><a href="kjikvadrattester.html"><i class="fa fa-check"></i><b>3.4</b> Kjikvadrattester</a></li>
<li class="chapter" data-level="3.5" data-path="oppgaver-1.html"><a href="oppgaver-1.html"><i class="fa fa-check"></i><b>3.5</b> Oppgaver</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="regresjon.html"><a href="regresjon.html"><i class="fa fa-check"></i><b>4</b> Regresjon</a>
<ul>
<li class="chapter" data-level="4.1" data-path="enkel-regresjon.html"><a href="enkel-regresjon.html"><i class="fa fa-check"></i><b>4.1</b> Enkel regresjon</a></li>
<li class="chapter" data-level="4.2" data-path="multippel-regresjon.html"><a href="multippel-regresjon.html"><i class="fa fa-check"></i><b>4.2</b> Multippel regresjon</a></li>
<li class="chapter" data-level="4.3" data-path="modellbygging.html"><a href="modellbygging.html"><i class="fa fa-check"></i><b>4.3</b> Modellbygging</a></li>
<li class="chapter" data-level="4.4" data-path="oppgaver-2.html"><a href="oppgaver-2.html"><i class="fa fa-check"></i><b>4.4</b> Oppgaver</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="avansert-regresjon-og-maskinlæring.html"><a href="avansert-regresjon-og-maskinlæring.html"><i class="fa fa-check"></i><b>5</b> Avansert regresjon og maskinlæring</a>
<ul>
<li class="chapter" data-level="5.1" data-path="logistisk-regresjon.html"><a href="logistisk-regresjon.html"><i class="fa fa-check"></i><b>5.1</b> Logistisk regresjon</a></li>
<li class="chapter" data-level="5.2" data-path="introduksjon-til-maskinlæring-med-knn.html"><a href="introduksjon-til-maskinlæring-med-knn.html"><i class="fa fa-check"></i><b>5.2</b> Introduksjon til maskinlæring med kNN</a></li>
<li class="chapter" data-level="5.3" data-path="paneldata.html"><a href="paneldata.html"><i class="fa fa-check"></i><b>5.3</b> Paneldata</a></li>
<li class="chapter" data-level="5.4" data-path="oppgaver-3.html"><a href="oppgaver-3.html"><i class="fa fa-check"></i><b>5.4</b> Oppgaver</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="tidsrekker.html"><a href="tidsrekker.html"><i class="fa fa-check"></i><b>6</b> Tidsrekker</a>
<ul>
<li class="chapter" data-level="6.1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>6.1</b> Introduksjon til tidsrekker</a></li>
<li class="chapter" data-level="6.2" data-path="trend-og-sesong.html"><a href="trend-og-sesong.html"><i class="fa fa-check"></i><b>6.2</b> Trend og sesong</a></li>
<li class="chapter" data-level="6.3" data-path="ar.html"><a href="ar.html"><i class="fa fa-check"></i><b>6.3</b> AR(p)</a></li>
<li class="chapter" data-level="6.4" data-path="stasjonaritet.html"><a href="stasjonaritet.html"><i class="fa fa-check"></i><b>6.4</b> Stasjonaritet</a></li>
<li class="chapter" data-level="6.5" data-path="autokorrelasjon.html"><a href="autokorrelasjon.html"><i class="fa fa-check"></i><b>6.5</b> Autokorrelasjon</a></li>
<li class="chapter" data-level="6.6" data-path="ma.html"><a href="ma.html"><i class="fa fa-check"></i><b>6.6</b> MA(q)</a></li>
<li class="chapter" data-level="6.7" data-path="arma-arima.html"><a href="arma-arima.html"><i class="fa fa-check"></i><b>6.7</b> ARMA og ARIMA</a></li>
<li class="chapter" data-level="6.8" data-path="modellbygging-1.html"><a href="modellbygging-1.html"><i class="fa fa-check"></i><b>6.8</b> Modellbygging</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="dataøvinger.html"><a href="dataøvinger.html"><i class="fa fa-check"></i><b>7</b> Dataøvinger</a>
<ul>
<li class="chapter" data-level="7.1" data-path="dataøving-1.html"><a href="dataøving-1.html"><i class="fa fa-check"></i><b>7.1</b> Dataøving 1</a></li>
<li class="chapter" data-level="7.2" data-path="dataøving-2.html"><a href="dataøving-2.html"><i class="fa fa-check"></i><b>7.2</b> Dataøving 2</a></li>
<li class="chapter" data-level="7.3" data-path="dataøving-3.html"><a href="dataøving-3.html"><i class="fa fa-check"></i><b>7.3</b> Dataøving 3</a></li>
<li class="chapter" data-level="7.4" data-path="dataøving-4.html"><a href="dataøving-4.html"><i class="fa fa-check"></i><b>7.4</b> Dataøving 4</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="diverse-ekstrastoff.html"><a href="diverse-ekstrastoff.html"><i class="fa fa-check"></i><b>8</b> Diverse ekstrastoff</a>
<ul>
<li class="chapter" data-level="8.1" data-path="skoleeksamen.html"><a href="skoleeksamen.html"><i class="fa fa-check"></i><b>8.1</b> Tidligere eksamensoppgaver (skoleeksamen)</a></li>
<li class="chapter" data-level="8.2" data-path="tidligere-eksamensoppgaver-hjemmeeksamen.html"><a href="tidligere-eksamensoppgaver-hjemmeeksamen.html"><i class="fa fa-check"></i><b>8.2</b> Tidligere eksamensoppgaver (hjemmeeksamen)</a></li>
<li class="chapter" data-level="8.3" data-path="spørsmål-og-svar.html"><a href="spørsmål-og-svar.html"><i class="fa fa-check"></i><b>8.3</b> Spørsmål og svar</a></li>
<li class="chapter" data-level="8.4" data-path="seminar.html"><a href="seminar.html"><i class="fa fa-check"></i><b>8.4</b> Oppgaver til seminarer</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://www.nhh.no/en/employees/faculty/hakon-otneim/">Håkon Otneim</a></li>
<li><a href="https://www.nhh.no/en/employees/faculty/geir-drage-berentsen/">Geir Drage Berentsen</a></li>
<li><a href="https://github.com/rstudio/bookdown">
Publisert ved hjelp av bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">MET4 - Empiriske Metoder - Høst 2021</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="dataøving-2" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> Dataøving 2</h2>
<div id="interaktiv-øvelse" class="section level3" number="7.2.1">
<h3><span class="header-section-number">7.2.1</span> Interaktiv øvelse</h3>
<p>Før vi tar fatt på dataanalysen begynner vi med litt R-trening i swirl. Har du allerede installert pakken <code>swirl</code> (skriv <code>install.packages("swirl")</code> i konsoll hvis ikke) starter du opp swirl med å skrive følgende i konsollen:</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="dataøving-2.html#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(swirl)</span>
<span id="cb171-2"><a href="dataøving-2.html#cb171-2" aria-hidden="true" tabindex="-1"></a><span class="fu">swirl</span>()</span></code></pre></div>
<p>Du vil i starten bli bedt om å skrive inn ditt navn. Hvis du bruker samme navn som tidligere får du kanskje tilbud om å starte opp igjen der du slapp, men da kan du bare velge det nederste valget ‘No. Let me start something new’. Du velger så alternativet ‘R Programming’ hvor du får se alle modulene dette kurset inneholder. I denne øvingen skal du prøve deg på modul 6 <strong>‘Subsetting Vectors’</strong> og modul 8 <strong>‘Logic’</strong>.</p>
<p>Husk at det helt til høyre vil står hvor langt du har kommet i prosent. Står du helt fast med et punkt kan du skrive <code>skip()</code> for å hoppe over dette punktet. Når du har fullført en modul blir du spurt om du vil motta ‘credit’ for å ha fullført modulen. Her kan du svare nei. Ønsker du å avbryte underveis skriver du <code>bye()</code>. Skriver du inn det samme navnet når du eventuelt starter swirl igjen kan du fortsette der du slapp. Husk å avslutt swirl () før du begynner på neste del av datalabben. Lykke til!</p>
</div>
<div id="data-til-dataøvelsen" class="section level3" number="7.2.2">
<h3><span class="header-section-number">7.2.2</span> Data til dataøvelsen</h3>
<p>I denne dataøvelsen skal vi ved hjelp av R gjennomføre en del av testene som vi har lært i praksis. Vi skal gjøre både ett- og to-utvalgs tester, og vi skal bruke <span class="math inline">\(\chi^2\)</span>-testen</p>
<p>Vi skal jobbe med tre ulike datasett i denne øvingen, og alle sammen kan lastes ned ved å klikke på lenkene under:</p>
<ul>
<li><a href="datasett/testdata.xls"><code>testdata.xls</code></a></li>
<li><a href="datasett/violence.xlsx"><code>violence.xlsx</code></a></li>
<li><a href="datasett/roubik_2002_coffe_yield.xlsx"><code>roubik_2002_coffee_yield.xlsx</code></a></li>
</ul>
<p>Last ned disse filene og legg dem i en mappe på datamaskinen din. Åpne så <strong>RStudio</strong>, velg <code>File -&gt; New File -&gt; R Script</code> for å åpne et nytt Rscript, og lag gjerne en liten overskrift ved hjelp av kommentartegnet <code>#</code>. Lagre så scriptet ditt i samme mappen som du har lagt datasettene, slik at du nå har en mappe som ser ut som figuren under:</p>
<p><img src="bilder/mappe2.png" /><!-- --></p>
<p>Det neste du må gjøre er å sørge for at du har satt opp riktig mappesti (working directory) i <strong>RStudio</strong>, og det gjør du raskest ved å velge <code>Session -&gt; Set Working Directory -&gt; To Source File Location</code>. Neste gang du skal jobbe med dette prosjektet kan du åpne <strong>RStudio</strong> ved å dobbeltklikke på <code>dataøving2.R</code>, og mappestien skal da settes automatisk til riktig mappe. I alle tilfeller skal vinduet ditt se omtrent slik ut:</p>
<p><img src="bilder/rstudio2.png" /><!-- --></p>
</div>
<div id="oppgaver-til-øvingen" class="section level3" number="7.2.3">
<h3><span class="header-section-number">7.2.3</span> Oppgaver til øvingen:</h3>
<div id="oppgave-1-1" class="section level4" number="7.2.3.1">
<h4><span class="header-section-number">7.2.3.1</span> Oppgave 1</h4>
<p>Costa Rica er en stor kaffeprodusent med moderne produksjon. Kaffeprodusentene har over lengre tid benyttet en standardisert miks av sprøytemidler som skal ta knekken på ugress og skadelige insekter, men uten å skade avlingen eller miljøet ellers.</p>
<p>En liten kaffeplantasje i Costa Rica har begynt å eksperimentere med en ny kombinasjon av sprøytemidler som skal være like effektiv mot ugress, men samtidig enda mer skånsom mot kaffeplantene, slik at avlingen blir større. Innehaveren av plantasjen ønsker å sette opp et eksperiment for å undersøke denne påstanden. Han velger ut 25 tilfeldige jordlapper fordelt på hele eiendommen der han bruker de nye sprøytemidlene gjennom en hel sesong.</p>
<p>Lang erfaring har vist at avlingen ved bruk av gammel metode er normalfordelt med forventning <span class="math inline">\(\mu = 100\)</span> og standardavvik <span class="math inline">\(\sigma = 10\)</span>, der vi har brukt en standardisert enhet for mengde avling per arealenhet. Hjelp bonden, ved å løse følgende oppgaver:</p>
<p><strong>Oppgave 1.1:</strong> Les inn datasettet <code>testdatasdata.xsl</code> i <strong>RStudio</strong> og se på de første par radene. Det kan du gjøre ved å kjøre følgende kodelinjer:</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="dataøving-2.html#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)                                 <span class="co"># Pakke for å lese excel-filer</span></span>
<span id="cb172-2"><a href="dataøving-2.html#cb172-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">&quot;testdata.xls&quot;</span>)              <span class="co"># Leser inn datasettet</span></span>
<span id="cb172-3"><a href="dataøving-2.html#cb172-3" aria-hidden="true" tabindex="-1"></a>data                                            <span class="co"># Ser på datasettet</span></span></code></pre></div>
<pre><code>## # A tibble: 25 x 4
##       X1    X2    A1    A2
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 122.  121.      1     1
##  2 101.  105       1     1
##  3 114.  108       1     1
##  4 103    99.1     1     0
##  5  97.6  96.2     0     0
##  6  85.9  95.4     0     0
##  7  93.5 101.      0     1
##  8  92    97       0     0
##  9  98.8 106.      0     1
## 10  99.9 100.      0     1
## # ... with 15 more rows</code></pre>
<p>Det er kolonnen <code>X2</code> som inneholder de observerte avlingene på de 25 forsøksseksjonene.</p>
<p><strong>Oppgave 1.2:</strong> Er forventet avling ved bruk av den nye metoden <em>større</em> enn forventet avling ved bruk av den gamle metoden? <em>Hint: Forelesningsnotatene/scriptet inneholder koden du trenger for å løse denne og neste oppgave.</em></p>
<p><strong>Oppgave 1.3:</strong> Det er viktig for kaffebonden at avlingen ikke varierer for mye mellom de ulike delene av farmen. En viktig måleparameter for denne type produksjon er derfor variansen. Kan vi slå fast at variansen til avlingen har forandret seg etter omlegging til ny metode?</p>
<p><strong>Oppgave 1.4:</strong> Kaffebonden er skeptisk til påstanden om at forventet avling med den gamle metoden er <span class="math inline">\(\mu = 100\)</span>, og mener at det vil variere med for eksempel jordsmonn. For å ta høyde for dette gjennomførte han året i forveien tilsvarende målinger på de samme jordlappene, med med gammel sprøytemetode. Disse målingene finner du i kolonne <code>X1</code> i datasettet. Test om avlingene er forskjellige, både med og uten paring av observasjonene. Kommenter resultatet.</p>
</div>
<div id="oppgave-2-1" class="section level4" number="7.2.3.2">
<h4><span class="header-section-number">7.2.3.2</span> Oppgave 2</h4>
<p>Vi skal i denne oppgaven se på oppgave <strong>1a</strong> og <strong>1b</strong> som ble gitt på skoleeksamen i MET4 vårsemesteret 2019. Dette er det samme datasettet som vi så på i forrige dataøving. I <a href="https://journals.sagepub.com/doi/10.1177/0956797619829688">et amerikansk forsøk</a> ville man undersøke påstanden om at voldelige dataspill fører til voldelig adferd ved la to grupper spille hvert sitt dataspill. I det “voldelige” dataspillet var oppdraget å <em>skyte</em> og <em>drepe</em> et romvesen, mens i den ikke-voldelige varianten skulle man <em>finne</em> og <em>redde</em> romvesenet fra fare. Utover det var spillene helt likt utformet, og i etterkant av en spilleøkt ble deltakernes aggresjonsnivå målt på en skala fra 1 til 9 ved hjelp av en standard psykologisk test.</p>
<p>I denne oppgaven skal vi i hovedsak finne ut om gruppen som spilte de voldelige dataspillet hadde signifikant høyere aggresjonsnivå enn kontrollgruppen.</p>
<p><strong>Oppgave 2.1:</strong> Les inn datasettet <code>violence.xslx</code> på samme måte som over. Hvis du allerede har kjørt <code>library(readxl)</code> trenger du ikke gjøre det igjen med mindre du har startet <strong>RStudio</strong> på nytt. Gi datasettet et passende navn, f.eks</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="dataøving-2.html#cb174-1" aria-hidden="true" tabindex="-1"></a>violence <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">&quot;violence.xlsx&quot;</span>)</span></code></pre></div>
<p>Vi skal altså teste om aggresjonsnivået er forskjellig i de to gruppene. Da må vi trekke ut de aktuelle tallene fra datasettet. Som vi husker fra forelesningsnotatene trenger vi <em>to vektorer</em> for å gjøre en to-utvags <span class="math inline">\(t\)</span>-test: en vektor som inneholder aggresjonsnivået til gruppen som har spilt det voldelige dataspillet, og en vektor som inneholder aggresjonsnivået til gruppen som har spilt det ikke-voldelige dataspillet.</p>
<p>La disse to vektorene få navn <code>voldelig</code> og <code>ikke_voldelig</code>, og lag dem ved å skrive følgende kodelinjer:</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="dataøving-2.html#cb175-1" aria-hidden="true" tabindex="-1"></a>voldelig      <span class="ot">&lt;-</span> violence<span class="sc">$</span>aggression_level[violence<span class="sc">$</span>violent_treatment <span class="sc">==</span> <span class="st">&quot;Violent&quot;</span>]</span>
<span id="cb175-2"><a href="dataøving-2.html#cb175-2" aria-hidden="true" tabindex="-1"></a>ikke_voldelig <span class="ot">&lt;-</span> violence<span class="sc">$</span>aggression_level[violence<span class="sc">$</span>violent_treatment <span class="sc">==</span> <span class="st">&quot;Less Violent&quot;</span>]</span></code></pre></div>
<p>For en forklaring på disse kodelinjene, se Dataøving 1.</p>
<p><strong>Oppgave 2.2:</strong> Vi er nå klare til å gjøre en to-utvalgs <span class="math inline">\(t\)</span>-test for om aggresjonsnivået er det samme i de to gruppene. Prøv å gjøre det nå, men vær bevisst på hvilke valg du gjør underveis, og som du mater inn i <code>t.test()</code>-funksjonen, f.eks:</p>
<ul>
<li>Antar du lik varians i de to gruppene? Hvorfor/Hvorfor ikke?</li>
<li>Bruker du ensidig eller tosidig test? Hvorfor?</li>
</ul>
<p><strong>Oppgave 2.3:</strong> En avgjørende detalj i studien som vi ser på i denne oppgaven er at forskerne også spurte forsøkspersonene hvorvidt de selv syntes spillet de spilte var voldelig. For å kunne trekke noen som helst lærdom fra et slikt forsøk er det viktig at den voldelige spillvarianten faktisk blir oppfattet som voldelig og vice versa. Vi ønsker dermed å undersøke nullhypotesen om at variablene <code>violence_tratment</code> og <code>experienced_violence</code> er uavhengige av hverandre. Den hypotesen er vi nødt til å forkaste for at forsøket skal være gyldig: hvis det ikke er noen sammenheng mellom opplevd og faktisk voldelighet er forsøket helt klart ugyldig.</p>
<p>Første steg er å lage et nytt datasett der vi bare ta med oss de to kolonnene vi er interessert i. Kall det hva du vil, f.eks. <code>violence_redusert</code>:</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="dataøving-2.html#cb176-1" aria-hidden="true" tabindex="-1"></a>violence_redusert <span class="ot">&lt;-</span> violence[<span class="fu">c</span>(<span class="st">&quot;violent_treatment&quot;</span>, <span class="st">&quot;experienced_violence&quot;</span>)]</span></code></pre></div>
<p>Vi fortsetter som i videoforelesningen og lager en krysstabell for disse variablene</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="dataøving-2.html#cb177-1" aria-hidden="true" tabindex="-1"></a>krysstabell <span class="ot">&lt;-</span> <span class="fu">table</span>(violence_redusert) </span>
<span id="cb177-2"><a href="dataøving-2.html#cb177-2" aria-hidden="true" tabindex="-1"></a>krysstabell</span></code></pre></div>
<pre><code>##                  experienced_violence
## violent_treatment Less Violent Violent
##      Less Violent          114       9
##      Violent                33      93</code></pre>
<p><strong>Oppgave 2.4:</strong> Heldigvis ser det ut til at det er en klar sammenheng mellom faktisk og opplevd voldelighet ved at de fleste forsøkspersonene havner på diagonalen i krysstabellen. Bruk funksjonen <code>chisq.test()</code> på samme måte som i forelesningen til å teste nullhypotesen om uavhengighet formelt.</p>
</div>
<div id="oppgave-3" class="section level4" number="7.2.3.3">
<h4><span class="header-section-number">7.2.3.3</span> Oppgave 3</h4>
<p>Vi skal i denne oppgaven returnere til kaffeproduksjon. Vi skal gjøre statistiske tester i R som i de tidligere oppgavene i denne øvingen, men vanskelighetsgraden går opp fordi vi også må tenke nøye over hvordan vi anvender metodene korrekt i en gitt kontekst.</p>
<p>I 2002 publiserte det prestisjetunge tidsskriftet <em>Nature</em> en kort artikkel skrevet av David W. Roubik<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>, som handler om den kjente kaffebønnen <em>Arabica</em>. Arabicabønnen kommer opprinnelig fra Afrika, og er en selvpollinerende plante. Det vil si at den ikke er avhengig av insekter for å formere seg, og man trodde lenge at den heller ikke hadde noen fordeler av insektspollinering.</p>
<p>For å undersøke denne påstanden samlet Roubik inn historiske data over arabicaavlinger fra hele verden. Han delte verdens kaffeproduserende land inn i to kategorier: <em>Old world</em> som omfatter afrikanske og asiatiske land, og <em>New world</em> som omfatter land i Latin-Amerika. Han registrerte videre <em>gjennomsnittlig årlig avling</em> (målt i kg/hektar) i to perioder: 1961–80 og 1981–2001.</p>
<p>Nøkkelen til analysen er at den afrikanske honningbien var en viktig pollinator i Afrika og Asia både i den første og andre perioden, men knapt eksisterte i Amerika før 1980. Etter 1980, derimot, økte utbredelsen av denne bien i Amerika, og ble fort naturalisert. Kan vi sette denne utviklingen i sammenheng med økt kaffeavling i Latin-Amerika etter 1980, og dermed skrote teorien om at kaffeplanter ikke drar nytte av insektspollinering?</p>
<p><strong>Oppgave 3.1:</strong> For å undersøke dette kan vi bruke datasettet som Roubik brukte, som finnes i filen <code>roubik_2002_coffe_yield.xlsx</code>. Last datasettet inn i R på vanlig måte, og se på det:</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="dataøving-2.html#cb179-1" aria-hidden="true" tabindex="-1"></a>yield <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">&quot;roubik_2002_coffe_yield.xlsx&quot;</span>)</span>
<span id="cb179-2"><a href="dataøving-2.html#cb179-2" aria-hidden="true" tabindex="-1"></a>yield</span></code></pre></div>
<pre><code>## # A tibble: 28 x 4
##    world country     yield_61_to_80 yield_81_to_01
##    &lt;chr&gt; &lt;chr&gt;                &lt;dbl&gt;          &lt;dbl&gt;
##  1 new   Costa_Rica            9139          14620
##  2 new   Bolivia               7686           8767
##  3 new   El_Salvador           9996           8729
##  4 new   Guatemala             5488           8231
##  5 new   Colombia              5920           7740
##  6 new   Honduras              4096           7264
##  7 new   Nicaragua             4566           6408
##  8 new   Brazil                4965           6283
##  9 new   Peru                  5487           5740
## 10 new   Mexico                5227           5116
## # ... with 18 more rows</code></pre>
<p>Vi ser at det er fire kolonner i datasettet:</p>
<ul>
<li><code>world</code> angir om det er snakk om <em>New world</em> (<code>new</code>) eller <em>Old world</em> (<code>old</code>).</li>
<li><code>country</code> angir navnet på landet.</li>
<li><code>yield_61_to_80</code> angir avlingen i perioden 1961–80.</li>
<li><code>yield_81_to_01</code> angir avlingen i perioden 1981–2001.</li>
</ul>
<p><strong>Oppgave 3.2:</strong> Kall den første tidsperioden <code>p1</code> og den andre tidsperioden <code>p2</code>. Lag så <em>fire</em> vektorer, en for hver kombinasjon av <code>world</code> og tidsperiode ved å bruke samme teknikk som i oppgave <strong>2.2</strong> over. Når du er ferdig, skal du ha laget følgende vektorer:</p>
<ul>
<li><code>new_p1</code>: inneholder avling for alle land med <code>world == new</code> i første periode.</li>
<li><code>new_p2</code>: inneholder avling for alle land med <code>world == new</code> i andre periode.</li>
<li><code>old_p1</code>: inneholder avling for alle land med <code>world == old</code> i første periode.</li>
<li><code>old_p2</code>: inneholder avling for alle land med <code>world == old</code> i andre periode.</li>
</ul>
<p>Dersom du har gjort det riktig, ser vektorene slik ut når du er ferdig:</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="dataøving-2.html#cb181-1" aria-hidden="true" tabindex="-1"></a>new_p1</span></code></pre></div>
<pre><code>##  [1] 9139 7686 9996 5488 5920 4096 4566 4965 5487 5227 2347 3089 1938</code></pre>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="dataøving-2.html#cb183-1" aria-hidden="true" tabindex="-1"></a>new_p2</span></code></pre></div>
<pre><code>##  [1] 14620  8767  8729  8231  7740  7264  6408  6283  5740  5116  4124  3240
## [13]  2789</code></pre>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="dataøving-2.html#cb185-1" aria-hidden="true" tabindex="-1"></a>old_p1</span></code></pre></div>
<pre><code>##  [1]  4251 10522  3509 10028  5667 17064  5904  4001  6604  4738  5716  3824
## [13]  3525  3393  3213</code></pre>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="dataøving-2.html#cb187-1" aria-hidden="true" tabindex="-1"></a>old_p2</span></code></pre></div>
<pre><code>##  [1] 13380 11561  9652  9593  8797  7869  7354  7288  6055  5432  5394  3576
## [13]  3141  2391  2136</code></pre>
<p><strong>Oppgave 3.3:</strong> Bruk en paret <span class="math inline">\(t\)</span>-test til å finne ut om kaffeavlingen i den gamle verden er signifikant forskjellig i de to tidsperiodene.</p>
<p><strong>Oppgave 3.4:</strong> Bruk en paret <span class="math inline">\(t\)</span>-test til å finne ut om kaffeavlingen i den nye verden er signifikant forskjellig i de to tidsperiodene.</p>
<p><strong>Oppgave 3.5 (Diskusjonsopgave):</strong> Dersom du har gjort de to foregående oppgavene riktig vil du se at den gjennomsnittlige kaffeavlingen ikke har endret seg signifikant i den gamle verden, mens økningen i den nye verden er klart statistisk signifikant. Vi har brukt parrede <span class="math inline">\(t\)</span>-tester, slik at vi “kontrollerer for” eventuelle landeffekter (denne terminologien blir skal vi bruke mer når vi skal jobbe med regresjon).</p>
<p>Roubik omtaler funnet som følger:</p>
<blockquote>
<p><em>A substantial increase in Latin American coffee yield partly coincided with the establishment of African honeybees in those countries, although there was no such change in the Old World, where honeybees originated […]. This comparison underlines a possible cause-and-effect relationship between the presence of social bees and cofee yield.</em></p>
</blockquote>
<p>Dette er intet mindre enn en <strong>kortslutning</strong>, på minst to forskjellige måter. Hvorfor? Diskuter med dine medstudenter. Kan det gjennomføres en enkel test som gir et bedre bilde av situasjonen?</p>
</div>
</div>
<div id="bonus-en-alternativ-teknikk-for-datamanipulering-gjør-bare-om-du-har-overskudd-til-det" class="section level3" number="7.2.4">
<h3><span class="header-section-number">7.2.4</span> BONUS: En alternativ teknikk for datamanipulering (Gjør bare om du har overskudd til det!)</h3>
<p>Se på denne kodelinjen:</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="dataøving-2.html#cb189-1" aria-hidden="true" tabindex="-1"></a>voldelig <span class="ot">&lt;-</span> violence<span class="sc">$</span>aggression_level[violence<span class="sc">$</span>violent_treatment <span class="sc">==</span> <span class="st">&quot;Violent&quot;</span>]</span></code></pre></div>
<p>Vi skrev denne linjen for å hente ut noen bestemte verdier fra et bestemt datasett. Det er kanskje ikke så lett å se hva kodelinjen gjør ved å bare kaste et raskt blikk på den, og det er spesielt to grunner til det:</p>
<ul>
<li>den er lang, og</li>
<li>du må lese den delvis “innenfra og ut” (alstå, begynne innerst i parantesene) og delvis fra høyre mot venstre.</li>
</ul>
<p>Spesielt det siste punktet er kontraintuitivt, siden det er motsatt av slik vi vanligvis leser. Mye arbeid i R går ut på å manipulere datasett på ulike vis (hente ut kolonner og rader, lage nye kolonner), og derfor er det utviklet noen alternative verktøy for å gjøre slike jobber mye mer effektivt. Vi vil i dette avsnittet gi en kort og meget grunleggende innføring i slike teknikker. Merk at dette ikke er <em>pensum</em> i klassisk forstand. Det viktigste er at jobben blir gjort korrekt. Hvordan du gjør det er i så måte underordnet.</p>
<p>For å gjennomføre øvelsen under må du installere og laste inn en ny pakke: <code>dplyr</code>:</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="dataøving-2.html#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;dplyr&quot;</span>)</span>
<span id="cb190-2"><a href="dataøving-2.html#cb190-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code></pre></div>
<div id="konsept-1-pipe-operatoren" class="section level4 unnumbered">
<h4>KONSEPT 1: Pipe-operatoren <code>%&gt;%</code></h4>
<p>Tenk deg at vi skal regne ut logaritmen til kvadratroten av 2. Vi må da anvende to funksjoner i riktig rekkefølge. Vi kan alltids bruke en mellomregning:</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="dataøving-2.html#cb191-1" aria-hidden="true" tabindex="-1"></a>kvadratroten_til_2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">2</span>)</span>
<span id="cb191-2"><a href="dataøving-2.html#cb191-2" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(kvadratroten_til_2)</span></code></pre></div>
<pre><code>## [1] 0.3465736</code></pre>
<p>Eventuelt kjører vi alt sammen i en linje:</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="dataøving-2.html#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(<span class="fu">sqrt</span>(<span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 0.3465736</code></pre>
<p>Nå er ikke den siste linjen spesielt lang, men den er som sagt ikke helt intuitiv. Grunnen er at hvis vi skal lese høyt hva den gjør, så må vi begynne innerst i parantesene: “Vi starter med tallet 2, så tar vi kvadratroten, så tar vi logaritmen…”</p>
<p>I <code>dplyr</code>-pakken finnes en såkalt pipe-operator som gjør at vi kan skrive dette som kode i den rekkefølgen ting skal skje. Eksempelet over skrives slik:</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="dataøving-2.html#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">%&gt;%</span> sqrt <span class="sc">%&gt;%</span> log</span></code></pre></div>
<pre><code>## [1] 0.3465736</code></pre>
<p>Det som skjer er at R leser linjen fra venstre, og ved hver “pipe/<code>%&gt;%</code>” sendes det som står på venstre side inn som argument i funksjonen på høyre side. Når du leser kode, kan denne operatoren uttales som <strong>så</strong> (<strong>then</strong> på engelsk): <strong>Først</strong> har vi tallet 2, <strong>så</strong> tar vi kvadratroten, <strong>så</strong> tar vi logaritmen.</p>
<p>Tenk når vi har en sekvens av 10 eller 20 eller 50 steg (ikke uvanlig i den virkelige verden), hvor mye enklere det blir å kode på denne måten fremfor å ha 10, 20 eller 50 nivå med paranteser!</p>
<p><strong>Tips:</strong> Hurtigtasten for <code>%&gt;%</code> i RStudio er <code>Ctrl - Shift - M</code> (Bytt ut <strong>Ctrl</strong> med <strong>Cmd</strong> på Mac).</p>
</div>
<div id="konsept-2-datamanipuleringsfunksjoner-i-dplyr" class="section level4 unnumbered">
<h4>KONSEPT 2: Datamanipuleringsfunksjoner i <code>dplyr</code></h4>
<p>I <code>dplyr</code> finnes det noen meget praktiske funksjoner som vi kan bruke til å manipulere datasatt i R. La oss ta utgangspunkt i datasettet <code>violence</code> og prøve å skrive om den aktuell kodelinjen over ved hjelp av pipe-operatoren. I klartekst skal vi gjøre følgende operasjoner:</p>
<ol style="list-style-type: decimal">
<li>Starte med datasettet <code>violence</code></li>
<li>Plukke ut alle radene som har verdi <code>"Violent"</code> i kolonnen <code>violent_treatment</code>.</li>
<li>Plukke ut kolonnen <code>aggression_level</code></li>
</ol>
<p>For å velge ut bestemte rader kan vi bruke funksjonen <code>filter()</code>. Ved hjelp av pipe-operatoren kan vi skrive steg 1 og 2 som</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="dataøving-2.html#cb197-1" aria-hidden="true" tabindex="-1"></a>violence <span class="sc">%&gt;%</span> <span class="fu">filter</span>(violent_treatment <span class="sc">==</span> <span class="st">&quot;Violent&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 126 x 5
##       id aggression_level violent_treatment difficulty_treatm~ experienced_viol~
##    &lt;dbl&gt;            &lt;dbl&gt; &lt;chr&gt;             &lt;chr&gt;              &lt;chr&gt;            
##  1     1                4 Violent           Easy               Less Violent     
##  2     2                5 Violent           Hard               Violent          
##  3     5                2 Violent           Easy               Violent          
##  4     6                9 Violent           Hard               Less Violent     
##  5    10                4 Violent           Hard               Violent          
##  6    18                4 Violent           Hard               Violent          
##  7    21                4 Violent           Easy               Violent          
##  8    22                9 Violent           Hard               Less Violent     
##  9    25                7 Violent           Easy               Violent          
## 10    26                1 Violent           Hard               Less Violent     
## # ... with 116 more rows</code></pre>
<p>Nå ser vi at vi bare har 126 rader igjen, og det er nettopp de radene som i kolonnen <code>violent_treatment</code> har verdi <code>"Violent"</code>. Det neste steget er å velge ut kolonnen <code>aggression_level</code>. Det gjør vi ved å bruke funksjonen <code>select()</code>, og hele sekvensen ser da slik ut (linjeskift gjør det enda mer lesbart):</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="dataøving-2.html#cb199-1" aria-hidden="true" tabindex="-1"></a>violence <span class="sc">%&gt;%</span> </span>
<span id="cb199-2"><a href="dataøving-2.html#cb199-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(violent_treatment <span class="sc">==</span> <span class="st">&quot;Violent&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb199-3"><a href="dataøving-2.html#cb199-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(aggression_level)</span></code></pre></div>
<pre><code>## # A tibble: 126 x 1
##    aggression_level
##               &lt;dbl&gt;
##  1                4
##  2                5
##  3                2
##  4                9
##  5                4
##  6                4
##  7                4
##  8                9
##  9                7
## 10                1
## # ... with 116 more rows</code></pre>
<p>Man kan velge flere kolonner ved å sette komma mellom kolonnenavn, og man kan i stedet velge <em>bort</em> kolonner ved å sette minustegn foran kolonnenavnet, f.eks:</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="dataøving-2.html#cb201-1" aria-hidden="true" tabindex="-1"></a>violence <span class="sc">%&gt;%</span> <span class="fu">select</span>(id, aggression_level)</span>
<span id="cb201-2"><a href="dataøving-2.html#cb201-2" aria-hidden="true" tabindex="-1"></a>violence <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>id)</span></code></pre></div>
<p>Nå har det seg slik at vi gjerne ønsker å hente ut den aktuelle kolonnen som en <em>vektor</em>. Det gjør vi enkelt ved å slenge på en <code>pull</code> på slutten av en pipe-sekvens. Til slutt må vi passe på å lagre vektoren med riktig navn, slik at vi får:</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="dataøving-2.html#cb202-1" aria-hidden="true" tabindex="-1"></a>voldelig <span class="ot">&lt;-</span> violence <span class="sc">%&gt;%</span> </span>
<span id="cb202-2"><a href="dataøving-2.html#cb202-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(violent_treatment <span class="sc">==</span> <span class="st">&quot;Violent&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb202-3"><a href="dataøving-2.html#cb202-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(aggression_level) <span class="sc">%&gt;%</span> </span>
<span id="cb202-4"><a href="dataøving-2.html#cb202-4" aria-hidden="true" tabindex="-1"></a>  pull</span></code></pre></div>
<p>Denne koden er ekvivalent med den som startet dette avsnittet i øvingen. Den er derimot mye enklere å lese, og <em>veldig</em> mye enklere å utvide til å inkludere flere operasjoner.</p>
<p>La oss se på enda en funksjon som vil være svært nyttig for oss senere. Vi kan bruke <code>mutate()</code> til å <em>lage nye kolonner</em>. La oss for eksempel si at vi vil lagre kvadratet av <code>aggression_level</code> eller summen av <code>aggression_level</code> og <code>id</code> som egne kolonner (som selvsagt er helt meningsløst i dette tilfellet, kun et eksempel). Det kan vi gjøre slik:</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="dataøving-2.html#cb203-1" aria-hidden="true" tabindex="-1"></a>violence <span class="sc">%&gt;%</span> </span>
<span id="cb203-2"><a href="dataøving-2.html#cb203-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ny1 =</span> aggression_level<span class="sc">^</span><span class="dv">2</span>) </span></code></pre></div>
<p>eller</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="dataøving-2.html#cb204-1" aria-hidden="true" tabindex="-1"></a>violence <span class="sc">%&gt;%</span> </span>
<span id="cb204-2"><a href="dataøving-2.html#cb204-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ny2 =</span> id <span class="sc">+</span> aggression_level)</span></code></pre></div>
<p>Her er <code>ny1</code> og <code>ny2</code> navn på de nye kolonnene, som vi kan velge selv.</p>
<p><strong>Oppgave:</strong> Gjenta <strong>Oppgave 3.2</strong>, men ved å bruke teknikkene i dette avsnittet.</p>
</div>
<div id="interaktiv-øving-i-dplyr" class="section level4 unnumbered">
<h4>Interaktiv øving i <code>dplyr</code></h4>
<p>Hvis du ønsker å trene mer på dette så finnes det en interaktiv modul i <code>swirl</code> som omhandler datamanipulasjon ved hjelp av <code>dplyr</code>. Hvis du ikke har gjort det alledede, skriv <code>install.packages("swirl")</code> i konsoll. Start du opp <code>swirl</code> med å skrive følgende:</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="dataøving-2.html#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(swirl)</span>
<span id="cb205-2"><a href="dataøving-2.html#cb205-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install_course</span>(<span class="st">&quot;Getting_and_Cleaning_Data &quot;</span>) <span class="co"># legger til nytt kursmateriale</span></span>
<span id="cb205-3"><a href="dataøving-2.html#cb205-3" aria-hidden="true" tabindex="-1"></a><span class="fu">swirl</span>()</span></code></pre></div>
<p>Du vil i starten bli bedt om å skrive inn ditt navn og så følger litt info om hvordan swirl fungerer. Du blir så bedt om å velge kurs. Her skal du først velge alternativet ‘Getting and Cleaning Data’. Du får så se alle modulene dette kurset inneholder. I denne øvingen skal du prøve deg på modul 1 <strong>‘Manipulating Data with dplyr’</strong>.</p>
</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>David W. Roubik: <em>The value of bees to the coffee harvest</em>. Nature (2002)<a href="dataøving-2.html#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="dataøving-1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="dataøving-3.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"toc_depth": 4
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
